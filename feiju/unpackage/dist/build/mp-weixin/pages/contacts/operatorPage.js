"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),u=require("../../api/apis.js"),l=require("../../config.js");if(!Array){(e.resolveComponent("uni-popup")+e.resolveComponent("uni-popup-message"))()}Math||((()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup-message/uni-popup-message.js"))();const o={__name:"operatorPage",setup(o){const v=e.ref(null),t=e.ref(null),n=e.ref(null),i=e.ref(""),c=e.ref([]),d=e.ref(""),p=e.ref(""),r=e.ref(""),s=e.ref(""),m=/^1[3-9]\d{9}$/;e.onLoad((e=>{n.value=e.value,i.value=e.id,i.value&&f(i.value)}));const f=async e=>{let a=await u.apiGetContactById(e);c.value=a.data},k=async()=>{if(C())return;200===(await u.apiAddContact({name:p.value,phone:r.value,remark:s.value,projectId:l.PROJECTID.globalProjectId})).code?(d.value="添加成功",t.value.open(),setTimeout((()=>{e.index.navigateBack()}),1500)):w("添加失败")};function h(){p.value=c.value.name,r.value=c.value.phone,s.value=c.value.remark,n.value="edit"}function _(){n.value="check"}const g=async()=>{if(C())return;c.value.name=p.value,c.value.phone=r.value,c.value.remark=s.value,200===(await u.apiUpdateContact(c.value)).code?(d.value="修改完成",t.value.open(),f(i.value),n.value="check"):w("修改失败")};function y(){v.value.open()}const j=async()=>{200===(await u.apiDeleteContact(i.value)).code?(d.value="删除成功",t.value.open(),v.value.close(),setTimeout((()=>{e.index.navigateBack()}),1500)):(w("删除失败"),v.value.close())};function x(){v.value.close()}const C=()=>p.value?!m.test(r.value)&&(w("请输入正确的手机号码"),!0):(w("请填写姓名"),!0);function w(a){e.index.showToast({title:a,icon:"none",duration:2e3})}const I=()=>{e.index.navigateBack()};return(u,l)=>e.e({a:a._imports_0$4,b:e.o(I),c:"add"===n.value},"add"===n.value?{}:{d:e.t(c.value.name)},{e:"edit"===n.value},"edit"===n.value?{f:a._imports_1$10}:{},{g:e.o(y),h:a._imports_2$3,i:"add"===n.value},"add"===n.value?{j:p.value,k:e.o((e=>p.value=e.detail.value))}:{},{l:"check"===n.value},"check"===n.value?{m:e.t(c.value.name)}:{},{n:"edit"===n.value},"edit"===n.value?{o:p.value,p:e.o((e=>p.value=e.detail.value))}:{},{q:"add"===n.value},"add"===n.value?{r:r.value,s:e.o((e=>r.value=e.detail.value))}:{},{t:"check"===n.value},"check"===n.value?{v:e.t(c.value.phone)}:{},{w:"edit"===n.value},"edit"===n.value?{x:r.value,y:e.o((e=>r.value=e.detail.value))}:{},{z:"add"===n.value},"add"===n.value?{A:s.value,B:e.o((e=>s.value=e.detail.value))}:{},{C:"check"===n.value},"check"===n.value?e.e({D:c.value.remark},c.value.remark?{E:e.t(c.value.remark)}:{}):{},{F:"edit"===n.value},"edit"===n.value?{G:s.value,H:e.o((e=>s.value=e.detail.value))}:{},{I:"add"===n.value},"add"===n.value?{J:e.o(k)}:{},{K:"check"===n.value},"check"===n.value?{L:a._imports_3$6,M:e.o(h)}:{},{N:"edit"===n.value},"edit"===n.value?{O:e.o(_),P:e.o(g)}:{},{Q:e.t(u.videoName),R:e.o(j),S:e.o(x),T:e.sr(v,"390ee74e-0",{k:"popup"}),U:e.p({type:"bottom","border-radius":"20rpx 20rpx 0 0","background-color":"#fff","safe-area":!0}),V:e.p({type:"success",message:d.value,duration:1e3}),W:e.sr(t,"390ee74e-1",{k:"deletePopup"}),X:e.p({type:"message"})})}},v=e._export_sfc(o,[["__scopeId","data-v-390ee74e"]]);wx.createPage(v);
