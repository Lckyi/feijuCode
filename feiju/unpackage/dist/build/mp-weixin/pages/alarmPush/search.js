"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),o=require("../../api/apis.js"),r=require("../../config.js");if(!Array){e.resolveComponent("uni-search-bar")()}Math;const l={__name:"search",setup(l){const t=e.ref("");e.ref(null);const n=e.ref(!1),c=e.ref(""),s=e.ref(""),u={pageNum:1,pageSize:20};e.onLoad((e=>{s.value=e.flag,console.log(s.value)}));const i=()=>{c.value="",t.value&&m()},v=async()=>{n.value||(u.pageNum++,m())},m=async()=>{let a;if("alarmRecord"===s.value)a=await o.apiGetAlarmRecords({projectId:r.PROJECTID.globalProjectId,pageNum:u.pageNum,pageSize:u.pageSize,deviceName:t.value}),c.value=[...c.value,...a.rows],u.pageSize>a.rows.length&&(n.value=!0);else{a=await o.apiGetRealTimeAlarm({projectId:r.PROJECTID.globalProjectId,deviceName:t.value,alarmState:1}),n.value=!0;const e=function(e,a=[]){for(let o in e)Array.isArray(e[o])&&e[o].forEach((e=>{"object"==typeof e&&null!==e&&a.push(e)}));return a}(a.data);console.log(e),c.value=[...c.value,...e]}e.index.setStorageSync("searchList",c.value)};const d=a=>{e.index.$emit("devName",a),e.index.navigateBack()};return e.onUnload((()=>{e.index.removeStorageSync("searchList")})),(o,r)=>e.e({a:a._imports_0$4,b:e.o((e=>d(""))),c:e.o(i),d:e.o((e=>t.value=e)),e:e.p({placeholder:"请输入设备名称",clearButton:"none",cancelButton:"none",modelValue:t.value}),f:c.value.length>0},c.value.length>0?{g:e.f(c.value,((a,o,r)=>({a:e.t(a.deviceName),b:a.alarmId,c:e.o((e=>d(a.deviceName)),a.alarmId)}))),h:a._imports_1$4,i:e.o(v)}:{j:a._imports_4$1})}},t=e._export_sfc(l,[["__scopeId","data-v-42e09b46"]]);wx.createPage(t);
