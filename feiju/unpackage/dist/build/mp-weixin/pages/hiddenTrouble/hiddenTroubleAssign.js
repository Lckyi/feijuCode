"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),o=require("../../api/apis.js");if(!Array){(e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-popup-message")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup-message/uni-popup-message.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const u={__name:"hiddenTroubleAssign",setup(u){const n=e.ref(0),i=e.ref(""),t=e.ref(""),s=e.ref(0),l=e.ref("日期选择"),p=e.ref(""),r=e.ref(""),v=e.ref("请选择"),d=e.reactive([{value:0,text:"发起运维指派"},{value:1,text:"无需处置"}]),c=e.ref(["请选择","一般隐患","严重隐患","较大隐患","重大隐患"]),m={};e.onLoad((e=>{i.value=e.id,m.id=i.value})),e.onShow((()=>{e.index.$on("personnel",(e=>{e&&(r.value=e.id,v.value=e.name)}))}));const f=async()=>{if(!m.id)return void g("隐患id为空");if(1===n.value){if(s.value<1)return void g("请选择隐患等级");m.level=s.value-1,m.state=3}else{if(s.value<1)return void g("请选择隐患等级");if("请选择"===v.value)return void g("请选择指派人员");if("日期选择"===l.value)return void g("请选择处置时限");m.disposer=r.value,m.closingDate=l.value,m.level=s.value-1,m.state=1,m.disposalSuggestion=p.value}200===(await o.apiPutHiddenDanger(m)).code?(t.value.open(),setTimeout((()=>{e.index.navigateBack()}),1500)):g("指派失败")};function g(a){e.index.showToast({title:a,icon:"none",duration:2e3})}const _=e=>{s.value=e.detail.value},x=e=>{l.value=e.detail.value};function h(){1!==n.value&&e.index.navigateTo({url:"/pages/hiddenTrouble/nameSearch"})}const k=()=>{e.index.navigateBack()};return(o,u)=>({a:a._imports_0$4,b:e.o(k),c:e.o(o.changeCheckbox),d:e.o((e=>n.value=e)),e:e.p({localdata:d,modelValue:n.value}),f:e.t(c.value[s.value]),g:a._imports_1$2,h:e.o(_),i:s.value,j:c.value,k:e.t(v.value),l:a._imports_1$2,m:e.o(h),n:e.t(l.value),o:a._imports_1$2,p:e.o(x),q:p.value,r:e.o((e=>p.value=e.detail.value)),s:0===n.value,t:e.o(f),v:e.p({type:"success",message:"判断成功",duration:1e3}),w:e.sr(t,"9540219e-1",{k:"deletePopup"}),x:e.p({type:"message"})})}},n=e._export_sfc(u,[["__scopeId","data-v-9540219e"]]);wx.createPage(n);
